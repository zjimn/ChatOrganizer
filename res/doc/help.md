## 达芬奇插件 素材清理助手 操作说明

该插件旨在帮助用户删除达芬奇项目中未使用的素材，并且提供了选项，可以选择是否同时删除本地磁盘上的文件。以下是详细的操作说明：

### 1. **插件功能简介**

  该插件能够执行以下功能：
  - **查找未使用的素材**：扫描当前项目，列出所有未在时间线上使用的素材。
  - **删除未使用的素材**：通过提供的选项，删除这些素材。
  - **选择是否删除磁盘数据**：可以选择仅删除项目中的素材（保留本地文件），或者同时删除本地文件。

### 2. **插件界面**

  插件打开后，会显示一个对话框，界面包括以下几个部分：

  - **当前未使用的素材数目**：如果存在未使用的素材，界面会显示“确定要删除XX条未使用的素材吗？”提示；如果没有未使用的素材，则会显示“当前没有未使用的素材”。
  - **查看按钮**：点击“点击查看”按钮，可以打开一个列表对话框，显示所有未使用的素材及其文件路径。
  - **删除磁盘数据选项**：可以选择是否在删除素材的同时，删除本地磁盘上的文件。勾选此选项后，点击“确定”会弹出二次确认对话框。
  - **操作按钮**：包括“确定”和“取消”按钮，点击“确定”会执行删除操作。

### 3. **安装步骤**

1. **解压文件**
   - 将下载的压缩文件解压到你选择的文件夹。

2. **复制插件文件**
   - 解压后，找到 ClipCleaner.py 文件。
   - 将 ClipCleaner.py 文件复制到达芬奇的脚本目录，具体路径如下：
  
     - 对于 **全局安装**：  
       %PROGRAMDATA%\Blackmagic Design\DaVinci Resolve\Fusion\Scripts\Edit
  
     - 对于 **用户安装**：  
       %APPDATA%\Roaming\Blackmagic Design\DaVinci Resolve\Support\Fusion\Scripts\Edit

     **提示**：你可以在文件资源管理器的地址栏中直接粘贴上述路径，按 Enter 键跳转到相应目录。


3. **安装python及依赖模块**
   1. 推荐安装anaconda3（已预装qt及其它依赖）
   2. 自己安装：
      1. 安装python
      2. 安装依赖PyQt5、send2trash

### 4. **操作步骤**

   1. **启动插件**：
      - 打开达芬奇软件，进入插件页面（Workspace -> Scripts），如果当前在Edit模块， 点击 ClipCleaner 启动，如果在当前在其它模块，点击 Edit -> ClipCleaner 启动
   
   2. **查看未使用素材**：
      - 插件会自动扫描项目中的素材，并显示未使用素材的数量。
      - 点击“点击查看”按钮，弹出一个列表对话框，列出所有未使用的素材及其文件路径。

   3. **删除素材**：
      - 如果你想删除这些未使用的素材，可以直接点击“确定”按钮。

   4. **二次确认**：
      - 若勾选了“同时删除本地文件”，会弹出二次确认对话框确认。

   5. **执行删除操作**：
      - 在确认删除后，插件会执行以下操作：
        - **删除本地文件**：当勾选了（同时删除本地文件）将相应未使用的本地素材文件也删除（本地文件删除后可以在回收站恢复）。
        - **删除素材**：将项目中的未使用素材删除。

### 5. **注意事项**
  - **日志查看**：可以打开达芬奇的控制台（Workspace -> Console）查看插件的运行记录。
  - **不可撤销操作**：如果勾选了同时删除本地文件，删除操作无法撤销，请谨慎操作。
  - **插件兼容性**：该插件要求使用>Python3.0 PyQt5 开发环境，确保你已经正确设置了插件运行所需的环境。

### 6. **意外情况处理**
  - **Workspace -> Scripts 没有相应的插件**：需先安装 python。可以安装anaconda3或自己下载安装包
  - **运行没有反应**：打开日志查看运行记录查看错误
  - **No module 错误**：安装相应缺失的模块
  - **No module named 'imp' 错误**：把 C:\ProgramData\Blackmagic Design\DaVinci Resolve\Support\Developer\Scripting\Modules\DaVinciResolveScript.py 文件 的第2行 import imp 修改为 import importlib as imp（import imp已弃用）
